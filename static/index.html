<!DOCTYPE html>
<html>
<head>
  <style>
    .spoiler-container {
      position: relative;
      display: inline-block;
    }
    .spoiler-overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: white;
      color: white;
      opacity: 0.95;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      cursor: pointer;
      transition: opacity 0.2s;
      z-index: 2;
    }
    .spoiler-overlay.hide {
      opacity: 0;
      pointer-events: none;
    }
    .spoiler-text {
      z-index: 1;
      color: black;
    }
  </style>
</head>
<body>
  <h2>Check Comment for Spoilers</h2>
  <textarea id="comment" rows="5" cols="60"></textarea><br>
  <button onclick="checkSpoiler()">Check</button>
  <div id="result"></div>
  <script>
    function checkSpoiler() {
      const comment = document.getElementById('comment').value;
      fetch('/check_comment', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({comment})
      })
      .then(res => res.json())
      .then(data => {
        let html = '';
        if (data.spoiler) {
          html = `
            <div class="spoiler-container">
              <div class="spoiler-text">${data.comment}</div>
              <div class="spoiler-overlay" id="spoiler-overlay" onclick="revealSpoiler()">
                Spoiler! Tap to reveal.
              </div>
            </div>
            <script>
            function revealSpoiler() {
              document.getElementById('spoiler-overlay').classList.add('hide');
            }
            </script>
          `;
        } else {
          html = `<div>${data.comment}</div>`;
        }
        document.getElementById('result').innerHTML = html;
      });
    }
  </script>
</body>
</html>
